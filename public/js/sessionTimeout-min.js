window.sessionTimeout=function(e){const t=Object.assign({appendTimestamp:!1,keepAliveMethod:"POST",keepAliveUrl:"/keep-alive",logOutBtnText:"Log out now",logOutUrl:"/log-out",message:"Your session is about to expire.",stayConnectedBtnText:"Stay connected",timeOutAfter:12e5,timeOutUrl:"/timed-out",titleText:"Session Timeout",warnAfter:9e5,showCountDownTimer:!1,showCountDownTimerInDialog:!1,countDownTimerInDialogId:"remainingTimeInDialog",countDownTimerId:"remainingTime"},e);let n,o,i,s=document.getElementById(t.countDownTimerId),d=Date.now()+t.timeOutAfter;const a=()=>{let e=Math.max(0,Math.round((d-Date.now())/1e3)),n=Math.floor(e/60),o=e%60,a=`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}`;s&&(s.innerText=a),t.showCountDownTimerInDialog&&C&&(C.innerText=a),e<=0&&clearInterval(i)},r=()=>{p.classList.remove("sessionTimeout--hidden")},l=()=>{window.location=t.timeOutUrl},c=()=>{d=Date.now()+t.timeOutAfter,n=setTimeout(r,t.warnAfter),clearTimeout(o),o=setTimeout(l,t.timeOutAfter),v.disabled=!1,v.innerText=t.stayConnectedBtnText,u("Session extended successfully","success")},m=e=>{window.location=t.logOutUrl},u=(e,t)=>{const n=document.createElement("div");n.style.cssText=`\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        padding: 12px 20px;\n        background: ${"success"===t?"#28a745":"#dc3545"};\n        color: white;\n        border-radius: 4px;\n        z-index: 10000;\n        font-size: 14px;\n    `,n.textContent=e,document.body.appendChild(n),setTimeout((()=>{n.parentNode&&n.parentNode.removeChild(n)}),3e3)},p=document.createElement("div"),T=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),g=document.createElement("div"),h=document.createElement("button"),v=document.createElement("button");let C;h.addEventListener("click",(()=>{window.location=t.logOutUrl})),v.addEventListener("click",(()=>{p.classList.add("sessionTimeout--hidden"),v.disabled=!0,v.innerText="Connecting...";const e=t.appendTimestamp?`${t.keepAliveUrl}?time=${Date.now()}`:t.keepAliveUrl,n=new XMLHttpRequest;n.onload=function(){if(200===n.status)try{!0===JSON.parse(n.responseText).success?c():m("Server rejected session extension")}catch(e){m("Invalid server response")}else m(`Server error: ${n.status}`)},n.onerror=function(){m("Network error - check connection")},n.ontimeout=function(){m("Request timeout - server slow")},n.open(t.keepAliveMethod,e),n.timeout=1e4,n.send()})),p.classList.add("sessionTimeout","sessionTimeout--hidden"),T.classList.add("sessionTimeout-modal"),x.classList.add("sessionTimeout-title"),w.classList.add("sessionTimeout-content"),g.classList.add("sessionTimeout-buttons"),h.classList.add("btn","btn-secondary"),h.style.marginRight="15px",v.classList.add("btn","btn-primary"),x.innerText=t.titleText,w.innerText=t.message,h.innerText=t.logOutBtnText,v.innerText=t.stayConnectedBtnText,t.showCountDownTimerInDialog&&(C=document.createElement("span"),C.id=t.countDownTimerInDialogId,C.style.display="block",C.style.marginTop="10px",C.style.fontWeight="bold",w.appendChild(C)),T.appendChild(x),T.appendChild(w),T.appendChild(g),g.appendChild(h),g.appendChild(v),p.appendChild(T),document.body.appendChild(p),n=setTimeout(r,t.warnAfter),o=setTimeout(l,t.timeOutAfter),t.showCountDownTimer&&(i=setInterval(a,1e3),a())};